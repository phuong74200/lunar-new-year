(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){(function(){const $=document.querySelector.bind(document);const btnShowBanner=$(".button-fortune");const btnCloseBanner=$(".button-close");const banner=$(".banner");const bannerText=$(".banner-text");const bannerContent=$(".banner-content");const bannerError=$(".banner-error");const bannerContentLove=$(".content-love");const bannerContentCareer=$(".content-career");const bannerContentMoney=$(".content-money");const vase=$(".vase");const vaseWrapper=$(".vase-wrapper");const tag=$(".tag-5");const inputDate=$(".input--date");const inputMonth=$(".input--month");const inputYear=$(".input--year");const lNumber=$("#lNumber");const inputs=$(".inputs");const isValidDate=(day,month,year)=>{if(isNaN(day)||isNaN(month)||isNaN(year)){return false}if(year<1e3||year>(new Date).getFullYear()||month<=0||month>12){return false}let monthLength=[31,28,31,30,31,30,31,31,30,31,30,31];if(year%400===0||year%100!==0&&year%4===0){monthLength[1]=29}return day>0&&day<=monthLength[month-1]};const timeOut=ms=>{return new Promise(resolve=>setTimeout(resolve,ms))};const showBanner=fortune=>{bannerContent.classList.remove("fade");bannerError.classList.add("fade");bannerContentLove.textContent=fortune.love;bannerContentCareer.textContent=fortune.career;bannerContentMoney.textContent=fortune.money;lNumber.textContent=`Con số vận mệnh của bạn trong năm 2022 là ${fortune.number}`;banner.classList.add("show");setTimeout(()=>{banner.classList.add("open")},1e3)};const showBannerError=(error="Đã có lỗi xảy ra. Vui lòng nhập lại")=>{bannerContent.classList.add("fade");bannerError.classList.remove("fade");bannerError.textContent=error;banner.classList.add("show");setTimeout(()=>{banner.classList.add("open")},1e3)};const shakeTag=async()=>{vase.classList.add("shake");await timeOut(2e3);vase.classList.remove("shake")};const takeTag=async()=>{tag.classList.add("tag-active");vaseWrapper.classList.add("zoom-in");await timeOut(4e3)};const closeAll=()=>{banner.classList.remove("show");banner.classList.remove("open");tag.classList.remove("tag-active");vaseWrapper.classList.remove("zoom-in");inputs.classList.remove("fade");inputDate.value="";inputMonth.value="";inputYear.value=""};const getFortune=async date=>{const URL="/api/prophecies";const settings={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:date})};const fetchResponse=await fetch(URL,settings);return fetchResponse.json()};btnShowBanner.addEventListener("click",async()=>{let date=inputDate.value;let month=inputMonth.value;let year=inputYear.value;inputs.classList.add("fade");console.log(isValidDate(+date,+month,+year));if(isValidDate(+date,+month,+year)){let dateString=date+"/"+month+"/"+year;console.log(+date,+month,+year);await shakeTag();await takeTag();getFortune(dateString).then(data=>{const{career,love,money,number}=data.status;showBanner({career:career,love:love,money:money,number:number})}).catch(err=>showBannerError("Đã có lỗi xảy ra. Vui lòng nhập lại"))}else{showBannerError("Ngày sinh không hợp lệ. Vui lòng nhập lại")}});btnCloseBanner.addEventListener("click",()=>{closeAll()});bannerText.addEventListener("mousewheel",event=>{event.stopPropagation()})})()},{}],2:[function(require,module,exports){const int=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;(function(){window.scrollTo(0,1);let app=new PIXI.Application({resizeTo:document.getElementById("round"),transparent:true});let upLayer=new PIXI.Application({resizeTo:window,transparent:true});upLayer.view.className="upLayer";document.getElementById("round").appendChild(app.view);document.body.appendChild(upLayer.view);const texture=PIXI.Texture.from("../assets/Untitled-1-15.png");const texture_1=PIXI.Texture.from("../assets/Untitled-1-16.png");let blossoms={};let mult=50;let now=performance.now();let now_2=performance.now();const layersDown=new Array(50).fill(null).map((layer,index)=>{return new PIXI.display.Group(index,false)});const layersUp=new Array(50).fill(null).map((layer,index)=>{return new PIXI.display.Group(index,false)});app.stage=new PIXI.display.Stage;app.stage.sortableChildren=true;upLayer.stage=new PIXI.display.Stage;upLayer.stage.sortableChildren=true;layersDown.forEach(layer=>{app.stage.addChild(new PIXI.display.Layer(layer))});layersUp.forEach(layer=>{app.stage.addChild(new PIXI.display.Layer(layer))});const update=()=>{Object.values(blossoms).forEach((blossom,index)=>{blossom.x+=blossom.sx;blossom.y+=blossom.sy;blossom.skew.set(1,blossom.skewX);blossom.skewX+=blossom.skewS;blossom.rotation+=blossom.sRotate;blossom.width+=blossom.sz||0;blossom.height+=blossom.sz||0;if(blossom.x>app.view.width*2||blossom.y>app.view.height*2){blossom.destroy();delete blossoms[blossom.id]}});if(app.ticker.FPS<=50)mult++;if(performance.now()-now>1920/window.innerWidth*mult){let size=int(10,30);const rotation=int(1,10)/400;now=performance.now();const id=Math.random();let sx=int(5,40)/30+size/30;let sy=int(5,40)/30+size/30;const skewX=int(180,360)*PIXI.DEG_TO_RAD;const skewS=PIXI.DEG_TO_RAD*(int(2,4)*Math.random())/5;const blossom=new PIXI.Sprite(int(1,10)%2==0?texture:texture_1);blossoms[id]=blossom;if(int(1,20)==10){size=int(100,150);blossom.filters=[new PIXI.filters.BlurFilter(size/20)];sx*=4;sy*=4}blossom.anchor.set(.5);if(int(1,100)%2==0){blossom.x=int(0,app.view.width);blossom.y=-50}else{blossom.y=int(0,app.view.height);blossom.x=-50}blossom.width=size;blossom.height=size;blossom.size=size;blossom.sRotate=rotation;blossom.skewX=skewX;blossom.skewS=skewS;blossom.id=id;blossom.sx=sx;blossom.sy=sy;if(size<30){blossom.parentGroup=layersDown[size-1]||layersDown[0];app.stage.addChild(blossom)}else{blossom.parentGroup=layersUp[size-50]||layersUp[0];upLayer.stage.addChild(blossom)}}if(performance.now()-now_2>mult){let size=int(1,10);const rotation=int(1,10)/400;now_2=performance.now();const id=Math.random();let sx=int(5,40)/10;let sy=int(5,40)/10;let sz=int(1,20)==10?Math.random()/10:0;const skewX=int(180,360)*PIXI.DEG_TO_RAD;const skewS=PIXI.DEG_TO_RAD*(int(2,4)*Math.random())/5;const blossom=new PIXI.Sprite(int(1,10)%2==0?texture:texture_1);blossoms[id]=blossom;blossom.zOrder=size;blossom.anchor.set(.5);if(int(1,100)%2==0){blossom.x=int(0,app.view.width);blossom.y=-50}else{blossom.y=int(0,app.view.height);blossom.x=-50}blossom.width=size;blossom.height=size;blossom.size=size;blossom.sRotate=rotation;blossom.skewX=skewX;blossom.skewS=skewS;blossom.id=id;blossom.sx=sx;blossom.sy=sy;blossom.sz=sz;if(size<30){blossom.parentGroup=layersDown[size-1]||layersDown[0];app.stage.addChild(blossom)}else{blossom.parentGroup=layersUp[size-50]||layersUp[0];upLayer.stage.addChild(blossom)}}};app.ticker.add(update)})();const hScroll=()=>{let ticking=false;let vertical=0;const slides=document.getElementsByClassName("h-scroll");[...slides].forEach((elm,index)=>{elm.style.transform=`translateX(${index*100}%)`});const page=document.getElementById("page");const work=()=>{if(vertical<=0){vertical=0}const anim=page.animate([{transform:`translateX(-${vertical*100}%)`}],{duration:500,fill:"forwards"});if(vertical>slides.length-1){vertical=0;work()}anim.onfinish=()=>{ticking=false}};const scrollPage=e=>{if(e.deltaY>0){vertical++}else if(e.deltaY<0){vertical--}work()};document.getElementById("arrowLeft").addEventListener("click",e=>{vertical--;work()});document.getElementById("arrowRight").addEventListener("click",e=>{vertical++;work()});document.addEventListener("mousewheel",function(e){if(!ticking){scrollPage(e);ticking=true}});document.addEventListener("touchstart",handleTouchStart,false);document.addEventListener("touchmove",handleTouchMove,false);var xDown=null;var yDown=null;function getTouches(evt){return evt.touches||evt.originalEvent.touches}function handleTouchStart(evt){const firstTouch=getTouches(evt)[0];xDown=firstTouch.clientX;yDown=firstTouch.clientY}function handleTouchMove(evt){if(!xDown||!yDown){return}var xUp=evt.touches[0].clientX;var yUp=evt.touches[0].clientY;var xDiff=xDown-xUp;var yDiff=yDown-yUp;if(Math.abs(xDiff)>Math.abs(yDiff)){if(xDiff>0){vertical+=1;work()}else{vertical-=1;work()}}else{if(yDiff>0){}else{}}xDown=null;yDown=null}};hScroll()},{}],3:[function(require,module,exports){(function(){const second=1e3,minute=second*60,hour=minute*60,day=hour*24;let nextYear="2/1/2022";const checkTime=new Date(nextYear).getTime()-(new Date).getTime();if(checkTime>0){document.getElementById("countDown").style.display="block"}const countDown=new Date(nextYear).getTime(),x=setInterval(function(){const now=(new Date).getTime(),distance=countDown-now;document.getElementById("days").innerText=Math.floor(distance/day).toString().padStart(2,"0"),document.getElementById("hours").innerText=Math.floor(distance%day/hour).toString().padStart(2,"0"),document.getElementById("minutes").innerText=Math.floor(distance%hour/minute).toString().padStart(2,"0"),document.getElementById("seconds").innerText=Math.floor(distance%minute/second).toString().padStart(2,"0");if(distance<0){document.getElementById("countDown").remove();document.getElementById("happyNewYear").style.display="flex";clearInterval(x)}},33)})()},{}],4:[function(require,module,exports){document.querySelector(".envelope").addEventListener("click",function(){if(document.querySelector(".letter").classList.contains("letter--open")){document.querySelector(".letter").classList.remove("letter--open");document.querySelector(".letter").classList.add("letter--close");setTimeout(function(){document.querySelector(".letter").classList.remove("letter--close")},600)}else{document.querySelector(".letter").classList.remove("letter--close");document.querySelector(".letter").classList.add("letter--open")}});document.querySelector(".paper-close").addEventListener("click",function(){document.querySelector(".letter").classList.remove("letter--open");document.querySelector(".letter").classList.add("letter--close");setTimeout(function(){console.log("closed");document.querySelector(".letter").classList.remove("letter--close");document.querySelector(".overlay").classList.add("displayNone");document.querySelector(".letter").classList.add("displayNone")},600)});document.querySelector(".content").addEventListener("submit",event=>{event.preventDefault();document.querySelector(".overlay").classList.remove("displayNone");setTimeout(function(){document.querySelector(".letter").classList.remove("displayNone")},600)});document.getElementById("submitBtn").addEventListener("click",e=>{const content=document.getElementById("input_msg").value;if(content.trim()){fetch("/api/wishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:content})}).then(response=>response.json()).then(result=>{if(result.success){document.getElementById("reponsedWish").textContent=result.status.message}else{document.getElementById("reponsedWish").textContent="Chúc bạn một năm mới vui vẻ!"}})}else{document.getElementById("reponsedWish").textContent="Chúc bạn một năm mới vui vẻ!"}})},{}]},{},[2,3,4,1]);
